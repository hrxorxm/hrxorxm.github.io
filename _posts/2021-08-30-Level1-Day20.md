---
layout: post
title:  "[Boostcamp AI Tech] 20ì¼ì°¨ í•™ìŠµì •ë¦¬"
subtitle:   "Naver Boostcamp AI Tech Level1 Day20"
categories: "Boostcamp-AI-Tech"
tags: [5ì£¼ì°¨]
use_math: true
---

# ë¶€ìŠ¤íŠ¸ìº í”„ 20ì¼ì°¨

## ğŸ“ ì˜¤ëŠ˜ ì¼ì • ì •ë¦¬

* 8/30 (ì›”)
  - [x] ëŒ€íšŒ ì§„í–‰ ë‚´ìš©
    - [x] íŒŒì´ì¬ í”„ë¡œì íŠ¸ë¡œ ì‹¤í—˜í™˜ê²½ êµ¬ì¶•
    - [x] face crop ì ìš©í•´ë³´ê¸°
  - [x] ì˜¤í”¼ìŠ¤ì•„ì›Œ 8/30 (ì›”) 18:00~19:00 ì´ë¯¸ì§€ ë¶„ë¥˜ ëŒ€íšŒ ì†”ë£¨ì…˜ ì„¤ëª… (ì´í˜¸ë¯¼ ë©˜í† ë‹˜)

## ğŸŒ± í”¼ì–´ ì„¸ì…˜ ì •ë¦¬

* ì˜¤ëŠ˜ ëª©í‘œ
  * ë©˜í† ë‹˜ì˜ ë² ì´ìŠ¤ë¼ì¸ì„ ë ˆíŒŒì§€í† ë¦¬ì— ì¶”ê°€ + ê°ì ì½”ë“œì™€ í†µí•©í•´ì„œ ì‹¤í—˜
* ë°©ì‹
  * ë² ì´ìŠ¤ë¼ì¸ mainë ˆí¬ ë‘ê³  ê°ì ë¸Œëœì¹˜ì—ì„œ ë² ì´ìŠ¤ë¼ì¸ìœ„ì— ë°ì´í„°ì…‹, ëª¨ë¸, í•¨ìˆ˜ ì ìš© í›„ ë¨¸ì§€í• ê²ƒë§Œ ë¨¸ì§€
  * test branchë¥¼ ë§Œë“¤ì–´ì„œ test branchì— ë¨¼ì € merge í•˜ì—¬ ê²€ì¦ í›„ main branchë¡œ merge
* ì—­í• ë¶„ë‹´
  * ê°ì ê°€ì„¤ì„ ì„¸ì›Œì„œ ê²€ì¦í•´ë³´ê³  ì‹¶ì€ ë‚´ìš©ì„ ì§‘ì¤‘í•´ì„œ ì‹¤í—˜í•˜ê³  ë‚´ìš©ì„ ê³µìœ í•˜ë©´ ë˜ì§€ ì•Šì„ê¹Œ

## ğŸš© ëŒ€íšŒ ì§„í–‰ ë‚´ìš©

### íŒŒì´ì¬ í”„ë¡œì íŠ¸ë¡œ ì‹¤í—˜í™˜ê²½ êµ¬ì¶•

* ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ì‹¤í–‰í•´ë³´ê¸°
  * `pythonÂ train.pyÂ --augmentationÂ CustomAugmentationÂ --modelÂ EfficientNet_b3Â --datasetÂ MaskSplitByProfileDataset`
* Tensorboard í™•ì¸í•˜ê¸°
  * `tensorboard --logdir=model --host=0.0.0.0 --port=6006`
* W&B ì—°ë™í•˜ê¸°
  ```python
  # Flexible integration for any Python script
  import wandb
  # 1. Start a W&B run
  wandb.init(project='mask-status-classification', entity='hrlee')
  # 2. Save model inputs and hyperparameters
  config = wandb.config
  config.learning_rate = 0.01
  # Model training here
  # 3. Log metrics over time to visualize performance
  wandb.log({"loss": loss})
  ```
* ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œë¡œ ì´ì‚¬í•˜ê¸°
  * early stopping ì¶”ê°€
  * metric : f1-score ì¶”ê°€

### face crop ì ìš©í•´ë³´ê¸°

* ë¼ë²¨ë§ ì—ëŸ¬ ì œê±°
  ```python
  for paths in os.listdir(img_path):
          # ë¼ë²¨ë§ ì—ëŸ¬ë‚˜ ìˆ¨ê¹€ íŒŒì¼ì€ ê±´ë„ˆë›°ê¸°
          label_error_ids = [
              '006359', '006360', '006361', '006362', '006363', '006364', # gender : male to female
              '001498-1', '004432', # gender : female to male
              '000020', '004418', '005227' # mask
          ]
          label_error = False
          for error_id in label_error_ids:
              if paths.startswith(error_id):
                  label_error = True
                  break
          if paths[0] == '.' or label_error:
              continue
          ...
  ```
* [facenet](https://github.com/timesler/facenet-pytorch)ìœ¼ë¡œ cropí•´ì„œ ì €ì¥í•˜ê¸°
  * origin dir : `/opt/ml/input/data/train/images`
  * new dir : `/opt/ml/input/data/train/face_images`

## ğŸ’ ì˜¤í”¼ìŠ¤ ì•„ì›Œ

* Image classification ê²½ì§„ëŒ€íšŒ(ë¡¯ë° ì œí’ˆ ì´ë¯¸ì§€ ë¶„ë¥˜) solution ê³µìœ 
* ì–´ë””ê¹Œì§€ ê°€ëŠëƒ ë³´ë‹¤ëŠ” ì–´ë–»ê²Œ ìƒê°í•´ì„œ ì§„í–‰í–ˆëŠëƒê°€ ì¤‘ìš”í•˜ë‹¤.

## ğŸ” ìŠ¤í˜ì…œ ë¯¸ì…˜

* Jupyter Notebook íƒˆì¶œ
  * Python IDLE í˜•ì‹ìœ¼ë¡œ í”„ë¡œì íŠ¸ì„ êµ¬ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
  * ì§€ê¸ˆê¹Œì§€ ë§Œë“¤ì—ˆë˜ Jupyter Notebookì„ ëª¨ì•„ì„œ í•˜ë‚˜ì˜ ë©‹ì§„ Python í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ëŠ”ê±´ ì–´ë–¨ê¹Œìš”?
  * [Jupyter Notebook vs Python IDLE](https://www.geeksforgeeks.org/jupyter-notebook-vs-python-idle/)

* ì˜ì¡´ì„±ì´ ìˆëŠ” Multi classification
  * ì´ë²ˆ ì»´í¼í‹°ì…˜ì€ ì£¼ì–´ì§„ ì •ë©´ ì‚¬ì§„ ì´ë¯¸ì§€ì— ëŒ€í•´ ì—°ë ¹, ì„±ë³„, ë§ˆìŠ¤í¬ ì°©ìš© ì—¬ë¶€ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì´ 18ê°œì˜ í´ë˜ìŠ¤ë¡œ ë‚˜ëˆ„ì–´ ë¶„ë¥˜
  * MLE(Maximum Likehood Estimation) ê´€ì ì—ì„œ ì£¼ì–´ì§„ ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” **ê°€ì¥ í™•ë¥ ì´ ë†’ì€ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡**í•˜ë„ë¡ ëª¨ë¸ì„ í•™ìŠµ, Softmaxí•¨ìˆ˜ë¥¼ í™œìš©í•´ì„œ ì£¼ì–´ì§„ ì´ë¯¸ì§€ê°€ ì–´ëŠ í´ë˜ìŠ¤ì— ê°€ì¥ ì í•©í•œ ì§€ ì¶œë ¥
  * **Multi classification ê´€ì ì—ì„œ ê°ê°ì˜ í´ë˜ìŠ¤ëŠ” ìƒí˜¸ ë°°íƒ€ì (Mutually Exclusive),** ë…ë¦½ì ì´ë¼ëŠ” ê°€ì •ì´ ë”°ë¥´ëŠ”ë°, ë§Œì•½ ì´ ì •ë‹µ í´ë˜ìŠ¤ ë“¤ì´ ì„œë¡œ ì–´ë–¤ ê³µí†µë¶„ëª¨ê°€ ì¡´ì¬í•´ì„œ **ì˜ì¡´ì„±ì´ ìˆëŠ” ê²½ìš°ë¼ë©´ ìœ„ì™€ ê°™ì´ í•™ìŠµí•˜ëŠ”ê²Œ ê³¼ì—° ì˜³ì€ ê²ƒì¼ê¹Œ?**

* ì¶”ê°€ë¡œ êµ¬í˜„í•´ë³¼ë§Œí•œ ìš”ì†Œ
  * Multi sample dropout
    * [ê´€ë ¨ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸](https://towardsdatascience.com/multi-sample-dropout-in-keras-ea8b8a9bfd83)
    * [ë…¼ë¬¸ ë§í¬](https://arxiv.org/abs/1905.09788)
    * [ì‚¬ìš©í•œ ìºê¸€ ìˆ˜ìƒì ê²Œì‹œê¸€](https://www.kaggle.com/c/jigsaw-unintended-bias-in-toxicity-classification/discussion/100961)
  * CutMix
    * [Cutmix ê³µì‹ ê¹ƒí—™](https://github.com/clovaai/CutMix-PyTorch)
    * [Cutmix ì˜ˆì‹œ](https://www.kaggle.com/debanga/cutmix-in-python)
  * Mixup

## ğŸš€ í•™ìŠµ íšŒê³ 

* ì‹¤í—˜í™˜ê²½ì´ ì–¼ì¶” ê°–ì¶°ì§„ ê²ƒ ê°™ì•„ì„œ ë‚´ì¼ì€ ë¶„ì„ì„ í•˜ë©´ì„œ ê°€ì„¤ì„ ì„¸ìš°ê³  ê²€ì¦í•˜ëŠ” ì‹œê°„ì„ ê°€ì ¸ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
* trainê³¼ test ë•Œ augmentationì„ ë‹¤ë¥´ê²Œ ì£¼ë©´ ë„ˆë¬´ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ëŠ” ê²ƒ ê°™ì•„ì„œ, ë‹¤ìŒë¶€í„°ëŠ” ìµœëŒ€í•œ ë¹„ìŠ·í•˜ê²Œ ë³€í˜•í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.


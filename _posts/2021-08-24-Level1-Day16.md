---
layout: post
title:  "[Boostcamp AI Tech] 16ì¼ì°¨ í•™ìŠµì •ë¦¬"
subtitle:   "Naver Boostcamp AI Tech Level1 Day16"
categories: "Boostcamp-AI-Tech"
tags: [4ì£¼ì°¨]
use_math: true
---

# ë¶€ìŠ¤íŠ¸ìº í”„ 16ì¼ì°¨

## ğŸ“ ì˜¤ëŠ˜ ì¼ì • ì •ë¦¬

* 8/24 (í™”)
  - [x] ì´ë¯¸ì§€ ë¶„ë¥˜ ê°•ì˜
    - [x] (3ê°•) Dataset
    - [x] (4ê°•) Data Generation
  - [x] ìŠ¤í˜ì…œ ë¯¸ì…˜ : Dataset / Data Generation

## ğŸ“š ê°•ì˜ ë‚´ìš© ì •ë¦¬

### [3ê°•] Dataset

* Data Science : Pre-processing 80%, Model/etc 20%
* Pre-processing
  * Bounding box : í•µì‹¬ ê°ì²´ê°€ ìˆëŠ” ê³³ì„ cropí•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
  * Resize : ì‘ì—…ì˜ íš¨ìœ¨í™”ë¥¼ ìœ„í•´, ë„ˆë¬´ í° ì´ë¯¸ì§€ëŠ” ì¤„ì¸ë‹¤.
  * ë„ë©”ì¸, ë°ì´í„° í˜•ì‹ì— ë”°ë¼ ì •ë§ ë‹¤ì–‘í•œ Caseê°€ ì¡´ì¬í•œë‹¤.
    * ex) APTOS Blindness Detection
* Generalization
  * Bias & Variance
    * High Bias : Underfitting
    * High Variance : Overfitting
  * Train / Validation
    * í›ˆë ¨ ì…‹ ì¤‘ ì¼ì • ë¶€ë¶„ì„ ë”°ë¡œ ë¶„ë¦¬í•˜ì—¬ ê²€ì¦ ì…‹ìœ¼ë¡œ í™œìš©
  * Data Augmentation
    * ì£¼ì–´ì§„ ë°ì´í„°ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” Case(ê²½ìš°)ì™€ State(ìƒíƒœ)ë¥¼ ë‹¤ì–‘í•˜ê²Œ ë§Œë“ ë‹¤.
    * `torchvision.transforms` / `Albumentations`
    * RandomCrop, Flip ë“± ë‹¤ì–‘í•œê²Œ ìˆì§€ë§Œ, ìš°ë¦¬ ë„ë©”ì¸ì—ì„œ ì˜ë¯¸ê°€ ìˆì„ì§€ë¥¼ ê³ ë¯¼í•´ë³´ê³  ì ìš©í•´ë³´ê¸°
    * í•­ìƒ ì¢‹ì€ ë°©ë²•ì€ ì—†ìœ¼ë‹ˆ ì‹¤í—˜ìœ¼ë¡œ ì¦ëª…í•˜ì

### [4ê°•] Data Generation

* Data Feeding
  * Feed : ëŒ€ìƒì˜ ìƒíƒœë¥¼ ê³ ë ¤í•´ì„œ ì ì •í•œ ì–‘ì„ ì¤€ë‹¤.
  * Data Generatorì˜ ì„±ëŠ¥ê³¼ Modelì˜ ì„±ëŠ¥ì„ ê³ ë ¤í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ tuningí•˜ê¸°
  * `transform.Compose` ë‚´ì˜ ê³„ì‚° ìˆœì„œì— ë”°ë¼ì„œë„ ì†ë„ì°¨ì´ê°€ í¬ë‹¤ (íŠ¹íˆ, `Resize`)
* Dataset
  * Vanilla Dataë¥¼ Datasetìœ¼ë¡œ ë³€í™˜
* DataLoader
  * ë‚´ê°€ ë§Œë“  Datasetì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê´€ë ¨ ê¸°ëŠ¥ ì¶”ê°€
  * ê°„ë‹¨í•œ ì‹¤í—˜ : `num_workers` ë“±
* Datasetê³¼ DataLoaderëŠ” ë¶„ë¦¬ë˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

## ğŸ” ë¯¸ì…˜ ìˆ˜í–‰ ê³¼ì •

* í´ë˜ìŠ¤ Labelì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” Dataset classë¥¼ ìƒì„±í•œ í›„ í´ë˜ìŠ¤ ë¶„í¬ë„ í™•ì¸í•´ë³´ê¸°
* `torchvision.transforms`, `albumentation`, `imgaug` ë“±ì„ ì´ìš©í•´ì„œ ì—¬ëŸ¬ transform ê¸°ë²•ì„ ì ìš©í•´ë³´ê¸°
* [catalyst](https://github.com/catalyst-team/catalyst) : balanced batch samplerì™€ ê°™ì€ APIë¥¼ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
* [ë‹¤ì–‘í•œ ì»¤ìŠ¤í…€ ë°ì´í„°ì…‹ ì˜ˆì œ](https://github.com/utkuozbulak/pytorch-custom-dataset-examples) : Taskì— ë§ëŠ” ì˜ˆì‹œ ì°¾ì•„ë³´ê¸°
* imbalanced class ì— ëŒ€í•œ loss ì— ê°€ì¤‘ì¹˜ ë¶€ì—¬í•˜ê¸°
  ```python
  weight = torch.tensor([1., 1., 5.]).to(device)
  loss = F.cross_entropy(scores, targets, weight=weight)
  ```

## ğŸŒ± í”¼ì–´ ì„¸ì…˜ ì •ë¦¬

* augmentationì„ ë¼ë²¨ì— ë”°ë¼ì„œ ë‹¤ë¥´ê²Œ í•´ë³´ì
* ë°°ì¹˜ì‚¬ì´ì¦ˆë„ ë‹¤ë¥´ê²Œ í•´ë³´ì
* [Albumentation](https://albumentations.ai/docs/) ë‹¤ì–‘í•˜ê²Œ ì ìš©í•´ë³´ì
  * CenterCrop
  * Gausian noise
  * To gray ë“± ìƒ‰ê¹” ë³€í™˜
  * [CutMix](https://github.com/clovaai/CutMix-PyTorch), Mixup, Cutout ë“±
  * Resize

## ğŸš€ í•™ìŠµ íšŒê³ 

* ë°ì´í„°ì…‹ ë§Œë“¤ ë•Œ, ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œë¥¼ ì˜ëª» ë¶ˆëŸ¬ì™€ì„œ, ë ˆì´ë¸”ë§ì´ ì˜ëª» ë˜ì–´ì„œ íŠ¹íˆ ë§ˆìŠ¤í¬ ëª¨ë¸ì´ í•™ìŠµì´ ì˜ ì•ˆ ëë‹¤. ë°ì´í„°ì…‹ ë°”ê¾¸ê³ , ë‹¤ì‹œ ëŒë¦¬ë‹ˆê¹Œ ì •ìƒì ìœ¼ë¡œ í•™ìŠµë˜ì—ˆë‹¤.
* pre-trained model ì‚¬ìš©í•  ë•Œ, fc layerë§Œ ë¹¼ê³  ë‚˜ë¨¸ì§€ íŒŒë¼ë¯¸í„°ëŠ” freeze í•˜ëŠ” ê²ƒì´ ì •ì„ì¸ì¤„ ì•Œì•˜ëŠ”ë°, freeze í•˜ì§€ ì•Šê³  í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì´ í›¨ì”¬ ë” ì„±ëŠ¥ì´ ì¢‹ì•˜ë‹¤.
* ì˜¤ëŠ˜ ì¼ë‹¨ ë¬¸ì œë¥¼ í•´ê²°í–ˆìœ¼ë‹ˆ, ë‚´ì¼ augmentation ì ìš©í•œ ëª¨ë¸ ëŒë ¤ë´ì•¼ê² ë‹¤.

